C51 COMPILER V9.60.7.0   SEG                                                               03/06/2024 18:40:53 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE SEG
OBJECT MODULE PLACED IN .\Objects\SEG.obj
COMPILER INVOKED BY: E:\Applications\Keil_5\C51\BIN\C51.EXE ..\Driver\SEG.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\User;..\S
                    -ys;..\Driver) DEBUG OBJECTEXTEND PRINT(.\Listings\SEG.lst) OBJECT(.\Objects\SEG.obj)

line level    source

   1          #include "SEG.h"
   2          #include "STC15F2K60S2.H"
   3          #include "STRING.h"
   4          code unsigned char  SMG_Table[]=
   5                          {0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,
   6               0x80,0x90,0x88,0x80,0xc6,0xc0,0x86,0x8e,
   7               0xbf,0x7f};
   8          //函数名：“字符串”到“数码管段码”的转换函数
   9          //入口参数：seg_string（10个字节）待转换的字符串；将转换完的段码存到seg_buf（8个字节）里
  10          //返回值：无
  11          //函数功能：将seg_string的各个位转换为数码管段码，存储到seg_buf数组中。
  12          void NumTran(unsigned char* seg_string,unsigned char* seg_buf)
  13          {       
  14   1              unsigned char i=0;
  15   1              unsigned char j=0;
  16   1              unsigned char temp;
  17   1              for(i=0;i<strlen(seg_string);i++,j++)
  18   1              {       
  19   2                      switch(seg_string[j]){
  20   3                              case '0': temp=SMG_Table[0]; break;
  21   3                              case '1': temp=SMG_Table[1]; break;
  22   3                              case '2': temp=SMG_Table[2]; break;
  23   3                              case '3': temp=SMG_Table[3]; break;
  24   3                              case '4': temp=SMG_Table[4]; break;
  25   3                              case '5': temp=SMG_Table[5]; break;
  26   3                              case '6': temp=SMG_Table[6]; break;
  27   3                              case '7': temp=SMG_Table[7]; break;
  28   3                              case '8': temp=SMG_Table[8]; break;
  29   3                              case '9': temp=SMG_Table[9]; break;
  30   3                              case 'A': temp=SMG_Table[10]; break;
  31   3                              case 'b': temp=SMG_Table[11]; break;
  32   3                              case 'C': temp=SMG_Table[12]; break;
  33   3                              case 'd': temp=SMG_Table[13]; break;
  34   3                              case 'E': temp=SMG_Table[14]; break;
  35   3                              case 'F': temp=SMG_Table[15]; break;
  36   3                              
  37   3                              default :temp=0xff; break;
  38   3                      }
  39   2                      if(seg_string[j+1]=='.'){//'.'和数字或者字母在同一个地方,所以要看下一个是不是'.'，再在temp里加
  40   3                              temp &= 0x7f;
  41   3                              j++;//跳过'.'
  42   3                      }
  43   2                      seg_buf[i]=temp;
  44   2              }
  45   1      }
  46          
  47          //函数名：将“段码数组”的第N位显示。
  48          //入口参数：seg_buf（8个字节）是转换完的段码; pos待显示的seg_buf第pos位。
  49          //返回值：无
  50          //函数功能：将seg_buf的第pos位显示在数码管的第pos位
  51          void NumShow(unsigned char* seg_buf,unsigned char pos)
  52          {
  53   1              P0=0x01<<pos;
  54   1              P2 =P2 & 0X1f | 0XC0;//y6
C51 COMPILER V9.60.7.0   SEG                                                               03/06/2024 18:40:53 PAGE 2   

  55   1              P2 &=0X1f ;
  56   1              
  57   1              P0 =0XFF;//clear
  58   1              P2 =P2 & 0X1f | 0XE0;//Y7
  59   1              P2 &=0X1f ;
  60   1              
  61   1              P0=seg_buf[pos];//传入
  62   1              P2 =P2 & 0X1f | 0XE0;//Y7
  63   1              P2 &=0X1f ;
  64   1      }
  65          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    301    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
