C51 COMPILER V9.60.7.0   SEG                                                               03/11/2024 21:11:57 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE SEG
OBJECT MODULE PLACED IN .\Objects\SEG.obj
COMPILER INVOKED BY: E:\Applications\Keil_5\C51\BIN\C51.EXE ..\Driver\SEG.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Driver;..
                    -\Sys;..\User) DEBUG OBJECTEXTEND PRINT(.\Listings\SEG.lst) OBJECT(.\Objects\SEG.obj)

line level    source

   1          #include "SEG.h"
   2          #include "STC15F2K60S2.H"
   3          #include "STRING.h"
   4          
   5          //函数名：“字符串”到“数码管段码”的转换函数
   6          //入口参数：seg_string（10个字节）待转换的字符串；将转换完的段码存到seg_buf（8个字节）里
   7          //返回值：无
   8          //函数功能：将seg_string的各个位转换为数码管段码，存储到seg_buf数组中。
   9          void NumTran(unsigned char* seg_string,unsigned char* seg_buf)
  10          {       
  11   1              unsigned char i=0;
  12   1              unsigned char j=0;
  13   1              unsigned char temp;
  14   1              for(i=0;i<8;i++,j++)
  15   1              {       
  16   2                      switch(seg_string[j]){
  17   3                              case '0': temp=0xc0; break;
  18   3                              case '1': temp=0xf9; break;
  19   3                              case '2': temp=0xa4; break;
  20   3                              case '3': temp=0xb0; break;
  21   3                              case '4': temp=0x99; break;
  22   3                              case '5': temp=0x92; break;
  23   3                              case '6': temp=0x82; break;
  24   3                              case '7': temp=0xf8; break;
  25   3                              case '8': temp=0x80; break;
  26   3                              case '9': temp=0x90; break;
  27   3                              case 'A': temp=0x88; break;
  28   3                              case 'b': temp=0x83; break;
  29   3                              case 'C': temp=0xc6; break;
  30   3                              case 'd': temp=0xa1; break;
  31   3                              case 'E': temp=0x86; break;
  32   3                              case 'F': temp=0x8e; break;
  33   3                              case '-': temp = 0xbf; break;
  34   3                              case ' ': temp = 0xff; break;
  35   3                              
  36   3                              default :temp=0xff; break;
  37   3                      }
  38   2                      if(seg_string[j+1]=='.'){//'.'和数字或者字母在同一个地方,所以要看下一个是不是'.'，再在temp里加
  39   3                              temp &= 0x7f;
  40   3                              j++;//跳过'.'
  41   3                      }
  42   2                      seg_buf[i]=temp;
  43   2              }
  44   1      }
  45          
  46          //函数名：将“段码数组”的第N位显示。
  47          //入口参数：seg_buf（8个字节）是转换完的段码; pos待显示的seg_buf第pos位。
  48          //返回值：无
  49          //函数功能：将seg_buf的第pos位显示在数码管的第pos位
  50          void NumShow(unsigned char* seg_buf,unsigned char pos)
  51          {
  52   1              P0=0x01<<pos;
  53   1              P2 =P2 & 0X1f | 0XC0;//y6
  54   1              P2 &=0X1f ;
C51 COMPILER V9.60.7.0   SEG                                                               03/11/2024 21:11:57 PAGE 2   

  55   1              
  56   1              P0 =0XFF;//clear
  57   1              P2 =P2 & 0X1f | 0XE0;//Y7
  58   1              P2 &=0X1f ;
  59   1              
  60   1              P0=seg_buf[pos];//传入
  61   1              P2 =P2 & 0X1f | 0XE0;//Y7
  62   1              P2 &=0X1f ;
  63   1      }
  64          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    298    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
