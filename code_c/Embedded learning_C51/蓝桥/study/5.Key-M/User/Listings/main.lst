C51 COMPILER V9.60.7.0   MAIN                                                              03/09/2024 20:16:28 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\Applications\Keil_5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Driver;..\Sys;..\U
                    -ser) DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          # include "STC15F2K60S2.H"
   2          # include "init.h"
   3          # include "timer.h"
   4          # include "LED.h"
   5          # include "stdio.h"
   6          # include "Key.h"
   7          
   8          /* º¯ÊýÉùÃ÷ */
   9          void Key_Proc(void);//°´¼ü´¦Àí£¬µ×²ãÊý¾Ý±ä¸ü
  10          
  11          //°´¼ü×¨ÓÃ£¬»ù±¾ÉÏÓÀÔ¶²»±ä
  12          unsigned char Key_Value;//¶ÁÈ¡°´¼üµÄÊýÖµ´æ´¢±äÁ¿
  13          unsigned char Key_Down, Key_Old;//¶ÁÈ¡°´¼üµÄÊýÖµ´æ´¢±äÁ¿        
  14          
  15          //°´¼üºÍÏÔÊ¾º¯Êý¼õËÙ×¨ÓÃ£¬»ù±¾ÓÀÔ¶²»±ä
  16          unsigned int Key_Slow_Down;//°´¼ü¼õËÙ
  17          unsigned int Seg_Slow_Down;//°´¼ü¼õËÙ
  18          
  19          //unsigned char LED_Show;
  20          unsigned char stat_k = 0;//×´Ì¬»ú
  21          void main()
  22          {
  23   1              init_close();
  24   1              Timer1_Init();//¶¨Ê±Æ÷1³õÊ¼»¯£¬²¢ÇÒÊ¹ÄÜ¶¨Ê±Æ÷1ÖÐ¶Ï£¬1ms½øÈëÒ»´Î
  25   1              EA = 1;//´ò¿ª×ÜÖÐ¶Ï
  26   1              
  27   1              while(1){
  28   2                      Key_Proc();
  29   2              }
  30   1      }
  31          /* Timer1_interrupt routine */
  32          void tm1_isr() interrupt 3
  33          {       
  34   1              
  35   1              //ÓÀÔ¶²»±ä
  36   1              if(++Key_Slow_Down == 10) Key_Slow_Down = 0;//Ã¿µ½10ms
  37   1              if(++Seg_Slow_Down == 500) Seg_Slow_Down = 0;
  38   1              
  39   1              
  40   1      }
  41          void Key_Proc(void)//°´¼ü´¦Àí£¬µ×²ãÊý¾Ý±ä¸ü
  42          {
  43   1              //ÓÀÔ¶²»±ä
  44   1              if(Key_Slow_Down) return;//Ã¿µ½10ms Seg_Slow_Down = 0
  45   1              Key_Slow_Down = 1;//¼õËÙ³ÌÐò
  46   1              
  47   1              Key_Value = Key_BIN();//¶ÁÈ¡°´¼ü°´ÏÂµÄ±àºÅ
  48   1      
  49   1      //      Key_Down = Key_Value & (Key_Old ^ Key_Value);// (0000^0101) = 0101     0101 & 0101 =0101  ,Èç¹û°´¼ü·¢Éú
             -ÁËÏÂ½µÑØµÄ±ä»¯£¬Êä³ö½á¹ûºÍ±¾´Î°´¼üÊýÖµÏàÍ¬                                                                                                                                                    // (0101^0101) = 0000       0101&0000 = 0000  Èç¹û°´¼üÒ»Ö±±
             -£³ÖÍ¬ÑùµÄ×´Ì¬£¬Êä³ö½á¹ûÎª0
  50   1      //      Key_Old = Key_Value;
  51   1              
  52   1              //¸ù¾Ý´úÂëÐèÇó·¢Éú±ä»¯
C51 COMPILER V9.60.7.0   MAIN                                                              03/09/2024 20:16:28 PAGE 2   

  53   1              switch(Key_Value)
  54   1              {       
  55   2                      case 7:
  56   2                              if(stat_k==0){
  57   3                              LED(0x01);
  58   3                              stat_k=1;}
  59   2                              else if(stat_k==1){
  60   3                              LED(0x00);
  61   3                              stat_k=0;
  62   3                              }
  63   2                              while(P30 ==0);
  64   2                              break;
  65   2                      case 6:
  66   2                              if(stat_k == 0)
  67   2                              {
  68   3                                      LED(0x02);
  69   3                                      stat_k = 2;
  70   3                              }
  71   2                              else if(stat_k == 2)
  72   2                              {
  73   3                                      LED(0x00);
  74   3                                      stat_k = 0;
  75   3                              }
  76   2                              while(P31 ==0);
  77   2                              break;
  78   2                      case 5:
  79   2                              if(stat_k == 1)
  80   2                              {       
  81   3                                      LED(0x04|0x01);
  82   3                                      while(P32 ==0);
  83   3                                      LED(0x01);
  84   3                              }
  85   2                              else if(stat_k == 2)
  86   2                              {       LED(0x10|0x02);
  87   3                                      while(P32 ==0);
  88   3                                      LED(0x02);
  89   3                              }
  90   2                              break;
  91   2                      case 4:
  92   2                              if(stat_k == 1)
  93   2                              {       
  94   3                                      LED(0x08|0x01);
  95   3                                      while(P33 ==0);
  96   3                                      LED(0x01);
  97   3                              }
  98   2                              else if(stat_k == 2)
  99   2                              {
 100   3                                      LED(0x20|0x02);
 101   3                                      while(P32 ==0);
 102   3                                      LED(0x02);
 103   3                              }
 104   2                              break;
 105   2                      case 0:break;
 106   2                              
 107   2              }
 108   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    255    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
C51 COMPILER V9.60.7.0   MAIN                                                              03/09/2024 20:16:28 PAGE 3   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
