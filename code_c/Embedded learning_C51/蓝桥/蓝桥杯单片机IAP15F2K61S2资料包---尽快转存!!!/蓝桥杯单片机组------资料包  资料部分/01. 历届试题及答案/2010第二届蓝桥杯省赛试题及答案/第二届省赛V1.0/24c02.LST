C51 COMPILER V9.02   24C02                                                                 03/19/2016 10:01:02 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE 24C02
OBJECT MODULE PLACED IN 24c02.OBJ
COMPILER INVOKED BY: D:\Program Files\keill\C51\BIN\C51.EXE 24c02.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <stc15f2k60s2.h>
   2          #include <intrins.h>
   3          sbit sda=P2^1;
   4          sbit scl=P2^0;
   5          void Snop()
   6          {
   7   1              _nop_();
   8   1              _nop_();
   9   1              _nop_();
  10   1              _nop_();
  11   1              _nop_();
  12   1              _nop_();
  13   1              _nop_();
  14   1              _nop_();
  15   1              _nop_();
  16   1      }
  17          void delay(unsigned char i)
  18          {
  19   1              unsigned char j;
  20   1              do{
  21   2                      for(j=0;j<112;j++);
  22   2              }while(i--);
  23   1      }
  24          void at24c02_start()
  25          {
  26   1              sda=1;
  27   1              scl=1;
  28   1              Snop();
  29   1          sda=0;
  30   1              Snop();
  31   1              scl=0;  
  32   1      }
  33          void at24c02_stop()
  34          {       
  35   1              sda=0;
  36   1              scl=1;
  37   1              Snop();
  38   1              sda=1;
  39   1              Snop();
  40   1              scl=0;
  41   1      }
  42          void at24c02_ack()
  43          {
  44   1              scl=0;
  45   1              sda=1;
  46   1              scl=1;
  47   1              Snop();
  48   1              if(sda)
  49   1              at24c02_stop();
  50   1              scl=0;                  
  51   1      }
  52          void at24c02_nack()
  53          {
  54   1              scl=0;
  55   1              sda=1;
C51 COMPILER V9.02   24C02                                                                 03/19/2016 10:01:02 PAGE 2   

  56   1              scl=1;
  57   1              Snop();
  58   1              sda=1;
  59   1              Snop();
  60   1              scl=0;                                  
  61   1      }
  62          void writebyte(unsigned char dat)
  63          {
  64   1              unsigned char i;
  65   1              for(i=0;i<8;i++)
  66   1              {
  67   2                      scl=0;
  68   2                      if(dat&0x80)
  69   2                      sda=1;
  70   2                      else
  71   2                      sda=0;
  72   2                      scl=1;
  73   2                      dat<<=1;
  74   2                      Snop(); 
  75   2              }       
  76   1      }
  77          unsigned char readbyte()
  78          {
  79   1              unsigned char i,dat;
  80   1              for(i=0;i<8;i++)
  81   1              {
  82   2                      scl=0;
  83   2                      Snop();
  84   2                      dat<<=1;
  85   2                      scl=1;
  86   2                      if(sda)
  87   2                      dat|=0x01;
  88   2                      else
  89   2                       dat&=0xfe;     
  90   2              }
  91   1              return dat;     
  92   1      }
  93          void at24c02_wirte(unsigned char add,unsigned char dat)
  94          {
  95   1              at24c02_start();
  96   1              writebyte(0xa0);
  97   1              at24c02_ack();
  98   1              writebyte(add);
  99   1              at24c02_ack();
 100   1              writebyte(dat);
 101   1              at24c02_ack();
 102   1              at24c02_stop();
 103   1              delay(30);
 104   1                                      
 105   1      }
 106          unsigned char at24c02_read(unsigned char add)
 107          {
 108   1              unsigned char dat;
 109   1              at24c02_start();
 110   1              writebyte(0xa0);
 111   1              at24c02_ack();
 112   1              writebyte(add);
 113   1              at24c02_ack();
 114   1              at24c02_start();
 115   1              writebyte(0xa1);
 116   1              at24c02_ack();
 117   1              dat=readbyte();
C51 COMPILER V9.02   24C02                                                                 03/19/2016 10:01:02 PAGE 3   

 118   1              at24c02_nack();
 119   1              at24c02_stop();
 120   1              return dat;                     
 121   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    203    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
