C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "ultrasonic.h"
   2          #include "action.h"
   3          #include "motor.h"
   4          #include "key.h"
   5          
   6          
   7          /**********************å®šä¹‰æŸäº›ç®¡è„š********************/
   8          bit candle_fire_1=0x01;//  1 is fire on ; 0 is extinguish
   9          bit candle_fire_9=0x01;//  1 is fire on ; 0 is extinguish
  10          bit candle_fire_3=0x00;////  1 is fire on ; 0 is extinguish
  11          bit candle_fire_2=0x01;////  1 is fire on ; 0 is extinguish
  12          
  13          
  14          sbit Fan = P0^0;
  15          sbit LeftFire = P0^2;
  16          sbit RightFire = P0^3;
  17          
  18          #define Fan_On {Fan = 0;}
  19          #define Fan_Off {Fan = 1;}
  20          
  21          
  22          
  23          unsigned char prevent_time = 0;
  24          unsigned int left_300 = 0;
  25          unsigned int right_900 = 0;
  26          unsigned int pwm_num = 0;
  27          unsigned int room_2_pwm_num = 0;
  28          unsigned int left_time=0;
  29          
  30          
  31          /******************ä¸»å‡½æ•°***************
  32          **************å®ç°åŠŸèƒ½ç§»åŠ¨ç­ç«**********/
  33          void main()
  34          {
  35   1        LED = 1;//äº®ç¯æŒ‡ç¤º
  36   1        Timer0Init();//å·¦è½®PWM
  37   1        Timer1Init();//å³è½®PWM
  38   1        Ultrasonic_Init();
  39   1        while(1)
  40   1        { 
  41   2          keyscan();//æŒ‰é”®æ£€æµ‹
  42   2          if(start==1)
  43   2          {
  44   3            /**********************æµ‹è¯•å³è½¬180Â°********************/
  45   3      //        turn_right_180();
  46   3      //        car_stop(); 
  47   3      //      
  48   3      //        while(1);//for(;;);
  49   3            front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
  50   3            front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
  51   3            front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
  52   3            front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
  53   3            right_dis= Ultrasonic_Get_Right();//å¾—åˆ°ä¸€æ¬¡å³è¶…å£°æ³¢æµ‹è·æ¨¡å—çš„è·ç¦»
  54   3            left_dis= Ultrasonic_Get_Left();//å¾—åˆ°ä¸€æ¬¡å·¦è¶…å£°æ³¢æµ‹è·æ¨¡å—çš„è·ç¦»
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 2   

  55   3            right_dis= Ultrasonic_Get_Right();
  56   3            left_dis= Ultrasonic_Get_Left();
  57   3            right_dis= Ultrasonic_Get_Right();
  58   3            left_dis= Ultrasonic_Get_Left();
  59   3            
  60   3            
  61   3            goto aaa;//è·³è½¬aaa
  62   3          //////////////////
  63   3      aaa:
  64   3            if(candle_fire_1==0x01)
  65   3            {
  66   4              do                   
  67   4              { 
  68   5                Circulation_wall_right();               
  69   5              }
  70   4              while(front_dis > 182);
  71   4              //now position is fire 1,and next step find fire 1      
  72   4              car_stop(); 
  73   4              
  74   4                    
  75   4              ////find_fire_turn_right();
  76   4              //now position is fire 1,and next step put off  fire 1    
  77   4              car_stop();
  78   4              
  79   4              do
  80   4              {
  81   5                Fan_On;     //-----------------ç­1---------------------
  82   5                delay_ms(1500);
  83   5                break;
  84   5              }
  85   4              while(LeftFire==0||RightFire==0);
  86   4              
  87   4              //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ2ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œ
  88   4              do
  89   4              {
  90   5                Fan_On;
  91   5                delay_ms(1500);
  92   5                break;
  93   5              }
  94   4              while(LeftFire==0||RightFire==0);
  95   4                    
  96   4              //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ0.5ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œä¿è¯å¹ç­
  97   4              
  98   4              Fan_Off;
  99   4              //////åŠ çš„
 100   4              delay_ms(150);
 101   4                //now position is fire 1,and next turn back       
 102   4                    
 103   4      //              find_fire_turn_back_left();
 104   4                    
 105   4                //now position is fire 1,and next turn left         
 106   4              car_stop();
 107   4              
 108   4              if(candle_fire_9==0x00&&candle_fire_3==0x00&&candle_fire_2==0x00)
 109   4              {
 110   5                turn_right_180();
 111   5                goto only_fire1_is_on_back_home;//ç­1è¿”èˆª
 112   5              }
 113   4              turn_left_90();//
 114   4              car_stop();
 115   4              
 116   4            }
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 3   

 117   3            else//----------------------1æ— ç«-----------------------
 118   3            {
 119   4              do                   //ä¸€å·æˆ¿é—´
 120   4              {
 121   5                Circulation_wall_right(); 
 122   5                //walkalone_left_1();               
 123   5              }
 124   4              while(front_dis > 182);//ç­ä¸€å·ç«çš„è·ç¦»
 125   4        //now position is fire 1,and next step find fire 1      
 126   4              car_stop();
 127   4              turn_left_90();//
 128   4            }
 129   3            /////////////////
 130   3      //
 131   3      //ä»1#ç€ç«ç‚¹å‡ºå‘ï¼Œå‡†å¤‡å¯»æ‰¾1#æˆ¿é—´çš„å¤§é—¨ä¸­å¤®ï¼Œä¼å›¾è¿›å…¥1å·æˆ¿é—´å¤§é—¨ã€‚
 132   3      //ä¸ºäº†é˜²æ­¢è¯¯åˆ¤ï¼Œæ£€æµ‹å¤§é—¨ï¼Œæ£€æµ‹ä¸¤æ¬¡ï¼ŒåŸå› æ˜¯åˆä¸€æ¬¡å‘ç°æµ‹ä¸å‡†è¿˜åœ¨1#ç€ç«ç‚¹ï¼Œ
             -å´è¯¯è®¤ä¸ºè‡ªå·±åœ¨1#å·æˆ¿é—´é—¨å£
 133   3      ////////////////////
 134   3              //now position is fire 1,and next walk alone withe the right wall 
 135   3               front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);//å¡å°”æ›¼æ»¤æ³¢
 136   3               left_dis= Ultrasonic_Get_Left();
 137   3               right_dis= Ultrasonic_Get_Right();
 138   3               if(candle_fire_9==0x01)
 139   3               {
 140   4                  i=0;
 141   4                  do                   //ä¸€å·æˆ¿é—´
 142   4                  {
 143   5                    Circulation_wall_right();
 144   5                  }
 145   4                  while(i<=30);
 146   4                  //ä¸ºäº†é˜²æ­¢è¯¯åˆ¤ï¼Œå‘ç°ä¸€å·æˆ¿é—´é—¨å£ æ‰§è¡Œä¸¤æ¬¡ã€‚å› ä¸ºè°ƒè¯•è¿‡ç¨‹ä¸­åœ¨ç«ç„°1å¤„åº”
             -ä¸ºå‰æ–¹è¶…å£°æµ‹è·é”™è¯¯ï¼Œæµ‹æˆ514æ¯«ç±³ï¼Œå®é™…åº”ä¸º1200æ¯«ç±³
 147   4                  //ï¼Œå¯¼è‡´æ»¡è¶³while(front_dis > 550||left_dis <600)æ¡ä»¶ï¼Œæ˜¯çš„å•ç‰‡æœºæœ¬åœ¨ç«ç„°1è¯¯è®¤ä¸º
             -åœ¨ä¸€å·æˆ¿é—´é—¨å£ï¼Œæ‰€ä»¥å†™ä¸¤æ¬¡
 148   4                  //å¸Œæœ›å‰æ–¹è¶…å£°æµ‹è·ä¸è¦çŒœæµ‹é”™äº†ã€‚
 149   4                      
 150   4                  delay_ms(100);
 151   4                    
 152   4                  left_dis= Ultrasonic_Get_Left();//å·¦ä¾§æ£€æŸ¥
 153   4                  right_dis= Ultrasonic_Get_Right();//å³ä¾§æ£€æŸ¥
 154   4                  
 155   4                  do                   //è¿›å…¥ä¸€å·æˆ¿é—´å‰â€”â€”å¯»æ‰¾å³å¢™
 156   4                  {
 157   5                    Circulation_wall_right();
 158   5                    left_dis= Ultrasonic_Get_Left();
 159   5                  }
 160   4                  while(front_dis > 580||left_dis <600);  //front_dis=660
 161   4                  
 162   4                  car_stop();
 163   4                  //now position is middle gate of room 1,and next action turn left 
 164   4                  delay_ms(50);
 165   4      
 166   4                  //          
 167   4                  /////////////////
 168   4                  //
 169   4                  //åœ¨1#æˆ¿é—´å¤§é—¨ä¸­å¤®ã€‚å‡†å¤‡è¿›å…¥å¤§é—¨ï¼Œå¹¶å·¡å³å¢™ åœ¨ç¦»å¢™177æ¯«ç±³å¤„åœä¸‹æ¥
 170   4                  ////////////////////            
 171   4                      
 172   4                  turn_left_90();          //è¿›å…¥æˆ¿é—´1
 173   4                      
 174   4                  //now position is middle gate of room 1,and next action pass through gate and walk alone with right 
             -wall         ///////////////  
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 4   

 175   4                  do
 176   4                  {
 177   5                    Circulation_wall_right();     
 178   5                  }
 179   4                  while(front_dis > 210);//æ”¹ä¸º20-5.19ï¼Œ23-5.20   230  250    230  210åˆé€‚
 180   4                  delay_ms(50);//-------------------
 181   4                //now position is corner 1 of room 1,and next action turn left
 182   4                  car_stop();
 183   4                  turn_left_90_big();             //å·¦è½¬
 184   4          //          
 185   4          /////////////////
 186   4          //
 187   4          //åœ¨1#æˆ¿é—´1å·æ‹è§’ï¼Œå‡†å¤‡å‰å¾€9#ç€ç«ç‚¹ã€‚å¹¶ç­ç«
 188   4          ////////////////////            
 189   4                      
 190   4                  //now position is corner 1 of room 1,and next action wanlk alone with right wall
 191   4                  do
 192   4                  {
 193   5                        Circulation_wall_right(); //å¯»å³å¢™   
 194   5                  }
 195   4                  while(front_dis > 210);//åŸæ•°æ®185æ”¹160-5.18ï¼Œ19-5.20,21-5.25
 196   4                  //now position is corner 2 of room 1,and next action find fire 2  
 197   4                  car_stop();
 198   4                  
 199   4                  //////begin find fire/////////////////////////
 200   4                  //
 201   4                  //car_stop();
 202   4      //                find_fire_turn_right();
 203   4                  
 204   4              //now position is corner 2 of room 1,and next action put off fire 2     
 205   4                      
 206   4                  do
 207   4                  {
 208   5                    Fan_On;     //-----------------ç­9ç«---------
 209   5                    delay_ms(1500);
 210   5                    break;
 211   5                  }
 212   4                  while(LeftFire==0||RightFire==0);
 213   4                  
 214   4                  //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ2ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œ
 215   4                  do
 216   4                  {
 217   5                    Fan_On;
 218   5                    delay_ms(1500);
 219   5                    break;
 220   5                  }
 221   4                  while(LeftFire==0||RightFire==0);
 222   4                  
 223   4                      
 224   4                  //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ0.5ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œä¿è¯å¹ç­
 225   4                  while(LeftFire==0||RightFire==0)
 226   4                  {
 227   5                    Fan_On;
 228   5                    delay_ms(1000);
 229   5                    break;
 230   5                  }
 231   4                      
 232   4                  Fan_Off;
 233   4                  //////åŠ çš„
 234   4                  delay_ms(100);
 235   4                  //now position is corner 2 of room 1,and next action turn back  
 236   4      //                find_fire_turn_back_left();
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 5   

 237   4                      
 238   4                      
 239   4                  //now position is corner 2 of room 1,and next action turn 180 degree  
 240   4                  car_stop();
 241   4                  turn_right_180();//å³è½¬æœ‰180Â°ä¸è¶³â€”â€”å·²è§£å†³
 242   4                  
 243   4                  
 244   4                  /******************************æœ‰è¯¯çš„åœ°æ–¹*******************************/
 245   4                  /*******************************å·²ç»è§£å†³********************************/
 246   4          /////////////////
 247   4          //
 248   4          //åœ¨9#ç€ç«ç‚¹ï¼Œå‡†å¤‡ç¦»å¼€ç€ç«ç‚¹ï¼Œå·¡å·¦å¢™ã€‚åœ¨ç¦»å¢™160æ¯«ç±³å¤„åœä¸‹æ¥
 249   4          ////////////////////              
 250   4                      ///////////////////////////////
 251   4                  //now position is corner 2 of room 1,and next action walk alone with left wall  
 252   4                    //-----------------é˜²è¯¯åˆ¤----------- 
 253   4                  i=0;
 254   4                  do
 255   4                  {
 256   5                    Circulation_wall_left();  //å¯»å·¦å¢™
 257   5                  }
 258   4                  while(left_dis < 390 && i < 24);//iåŸæ•°æ®ä¸º12æ”¹ä¸º-24ï¼Œ5-18
 259   4                  
 260   4                  
 261   4                //----------------------------------  
 262   4                  
 263   4                  do
 264   4                  {
 265   5                    front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);//å¡å°”æ›¼æ»¤æ³¢
 266   5                    Circulation_wall_left();  //å¯»å·¦å¢™   
 267   5                  }
 268   4                  while(front_dis > 179);//18cmï¼Œ230-5.20    3.23-260    180åˆé€‚   175ç¨å¾®æœ‰ç‚¹ç´§
 269   4                // turn right at the cornner 1  
 270   4                  car_stop();
 271   4                  turn_right_90_small();
 272   4                  
 273   4          //////////////////
 274   4            
 275   4      //å¼€æœºå‡ºå‘ï¼Œå·¡å³å¢™ï¼Œåœ¨ç¦»å¢™180æ¯«ç±³å¤„åœä¸‹
 276   4      //å¹¶åœ¨3#è¡—é“åœä¸‹æ¥ï¼Œç¦»å¢™180æ¯«ç±³åœã€‚
 277   4      // now potion is cornre 3 of  room 2,next action  walk alone right wall
 278   4          ///////////////////
 279   4                  /////////////////
 280   4          //
 281   4          //åœ¨1#æˆ¿é—´ï¼Œæ‹è§’1ï¼Œå‡†å¤‡ç¦»å¼€ä¸€å·æˆ¿é—´ï¼Œå·¡å·¦å¢™èµ°ï¼Œåœ¨ç¦»å¢™160æ¯«ç±³å¤„åœä¸‹æ¥
 282   4          ////////////////////  19å¹´æ”¹190           
 283   4      
 284   4                      
 285   4                    /// now postion is room 1 corner 1 and walk alone left wall  and next action stop at the street 
 286   4                  do
 287   4                  {
 288   5                    front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);//å¡å°”æ›¼æ»¤æ³¢
 289   5                    Circulation_wall_left();//å¯»å·¦å¢™     
 290   5                  }
 291   4                  while(front_dis > 230);//é©¶å‡ºåˆ°1å·æˆ¿é—´å‡ºå£1#è¡—åŒºå¤„å‰å¢™19cm   23cmåˆé€‚
 292   4                  
 293   4                // now potion is street and nearby is the gate of room1 ,turn left 90 degree. 
 294   4                  
 295   4                   car_stop();
 296   4                      
 297   4                  if(candle_fire_3==0x00&&candle_fire_2==0x00)//èœ¡çƒ›2å’Œèœ¡çƒ›3ç­
 298   4                  {
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 6   

 299   5                    turn_right_90();//-----------------å›å®¶
 300   5                    do
 301   5                    {
 302   6                      Circulation_wall_left();  //å¯»å·¦å¢™   
 303   6                    }
 304   5                    while(front_dis > 200);//å‰æ–¹20cmå¤„
 305   5                    
 306   5                    
 307   5                    /********************************å³è½¬å›å®¶å®¶******************************/
 308   5                    turn_right_90();
 309   5                    goto only_fire_9_fire_1_is_on_back_home;//ç­èœ¡çƒ›1å’Œèœ¡çƒ›9åå›å®¶
 310   5                  }
 311   4                  
 312   4                  
 313   4                  
 314   4                  /******************å‡ºå»1#å*********************/
 315   4                  turn_left_90();
 316   4          /////////////////
 317   4          //
 318   4          //åœ¨1#æˆ¿é—´é—¨å£ï¼Œä¸”å¤„åœ¨2#è¡—é“ä¸Šï¼Œå¹¶ç¦»å¢™160æ¯«ç±³ã€‚å‡†å¤‡å·¡å³å¢™èµ°åˆ°2#å¤§è¡—å°½å¤´ï¼Œ
 319   4          ////////////////////              
 320   4                      ///////////////////////////////           
 321   4                      
 322   4                    // now potion is street and nearby is the gate of room1 walk alone right.and next action stop at th
             -e end of street   
 323   4                  do
 324   4                  {
 325   5                    Circulation_wall_right();     
 326   5                  }
 327   4                  while(front_dis > 200);//180   
 328   4      
 329   4                    // now potion is end of street 2 ,next action is turn left 90   
 330   4                  car_stop();
 331   4                  
 332   4                  turn_left_90();//å·¦è½¬90Â°è¿›å»ä¸€å·æˆ¿é—´å’ŒäºŒå·æˆ¿é—´çš„ä¸­é—´è¿‡é“
 333   4                }
 334   3                  
 335   3                else if(candle_fire_3==0x01||candle_fire_2==0x01)//èœ¡çƒ›2èœ¡çƒ›3ç‡ƒçƒ§
 336   3                {
 337   4                  do
 338   4                  {
 339   5                    Circulation_wall_right(); //å¯»å³å¢™   
 340   5                  }
 341   4                    while(front_dis > 200);//è·ç¦»äºŒå·æˆ¿é—´å‰æ–¹17.7cmå¤„å·¦è½¬90Â°ï¼Œ200-5.20
 342   4                  // now potion is end of street 2 ,next action is turn left 90   
 343   4                  car_stop();
 344   4                  turn_left_90();
 345   4                }
 346   3                  /***********************æ²¡ææ‡‚5-18**********************/
 347   3                else
 348   3                {
 349   4                  turn_left_90();//è¿™é‡Œå›å®¶
 350   4                  goto only_fire1_is_on_back_home;
 351   4                }
 352   3            
 353   3      
 354   3      //
 355   3      //åœ¨2#è¡—é“çš„å°½ç«¯ï¼Œå‡†å¤‡å‰å¾€2#æˆ¿é—´ã€‚å…ˆå·¡å³å¢™èµ°ï¼Œå‘ç°å·¦å¢™ï¼Œç«‹åˆ»å·¡å·¦å¢™ï¼Œä¸€ç›´è
             -µ°åˆ°2#æˆ¿é—´å¤§é—¨ä¸­å¤®
 356   3      ////////////////////            
 357   3                // now potion is end of street2,next action iswalk alone right wall   
 358   3                //è¿™ä¸€æ®µç¨‹åºè¾ƒä¸ºéº»çƒ¦ã€‚é€ æˆéº»çƒ¦çš„åŸå› æ˜¯å¤„äºæ‹è§’æ—¶ï¼Œæµ‹å³å¢™æ•°æ®å¤„äºæ··æ²Œ
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 7   

             -çŠ¶æ€ï¼Œåº”è¯¥ä¸º172æ¯«ç±³ï¼Œå¯æ˜¯å¤„äºç›´è§’è¾¹ç¼˜æ—¶
 359   3                  //æ•°æ®å˜å¤§ï¼Œç”šè‡³èƒ½å˜æˆ220,250ï¼Œä¹ƒè‡³300å¤šï¼Œè€Œä¸”è¿™ä¸ªæ··æ²ŒåŒºåŸŸé•¿åº¦è¿˜ä¸å°ï¼Œæ
             -œ‰å¤§çº¦50æ¯«ç±³ã€‚
 360   3                  
 361   3      /////////////////
 362   3      //
 363   3      //å…ˆå·¡å³å¢™èµ°ï¼Œä¸€ç›´æœç´¢å·¦å¢™ï¼Œç›´åˆ°ç¨³å®šçš„å‘ç°å·¦å¢™ï¼Œ
 364   3      ////////////////////
 365   3                
 366   3                
 367   3                
 368   3                
 369   3                  left_300=0x00;
 370   3                  do
 371   3                  {
 372   4                    Circulation_wall_right();//å…ˆå¯»å³å¢™
 373   4                    left_dis= Ultrasonic_Get_Left();
 374   4                    
 375   4                    if(left_dis<300)
 376   4                    {
 377   5                      left_300++;
 378   5                    }
 379   4                    else
 380   4                    {
 381   5                      left_300=0x00;
 382   5                    }
 383   4                  }
 384   3                  while(left_dis>300||left_300<=3);//front_dis > 580||left_dis <600
 385   3                  //car_stop();
 386   3                  //car_stop();
 387   3                  
 388   3      /////////////           
 389   3      //è¿™æ—¶å°è½¦3#è¡—é“å·¦å¢™é¦–ç«¯ï¼Œä¸‹é¢å¼€å§‹å¯»æ‰¾å·¦å¢™èµ°ï¼Œå³è¾¹æœ‰ç¨³å®šçš„å¤§äº800çš„æ•°æ®ï¼Œ
             -è¿™å°±æ˜¯åˆ°äº†2å·æˆ¿é—´çš„é—¨è¾¹ç¼˜
 390   3      ///////////////
 391   3                
 392   3                  right_900=0;
 393   3                  do
 394   3                  {
 395   4                    Circulation_wall_right();
 396   4                    
 397   4                    if(right_dis>800)
 398   4                    {
 399   5                      right_900++;
 400   5                      if(right_900>=0x03)
 401   5                      {
 402   6                        car_stop();
 403   6                        break;
 404   6                      }
 405   5                    }
 406   4                    else
 407   4                    {
 408   5                      right_900=0x00;
 409   5                    }
 410   4                  }while(right_dis<800||right_dis<=3);
 411   3                  
 412   3                  
 413   3                  car_stop();
 414   3      /***************************************æ­¤å¤„æœ‰é—®é¢˜*****************************/
 415   3                  /************************æ— æ³•è¿›å…¥2#æˆ¿é—´***************************/
 416   3                  /**************************é—®é¢˜å·²è§£å†³*****************************/
 417   3                  //while(front_dis > 1400||right_dis <600);//front_dis > 580||left_dis <600
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 8   

 418   3                // now potion is begin of door of room 2,next action is walk forward 20 cm  
 419   3      //            car_stop();
 420   3                  
 421   3      /////////////           
 422   3      //è¿™æ—¶å°è½¦2å·æˆ¿é—´å¤§é—¨å£ï¼Œä½†ä¸æ˜¯å¤§é—¨ä¸­å¤®ï¼Œå‡†å¤‡å‰å¾€å¤§é—¨ä¸­å¤®
 423   3      ///////////////
 424   3      
 425   3                  i=0x00;
 426   3                  
 427   3                  do
 428   3                  {
 429   4                    Circulation_wall_right();//å¯»å³å¢™
 430   4                    
 431   4                    }while(i<=45);  //50æ”¹ä¸º44   44    48
 432   3                  
 433   3                // now potion is middle of door of room 2,next action isturn right 90 
 434   3                  car_stop();
 435   3                  turn_right_90();//å³è½¬90Â°
 436   3          
 437   3                // now potion is middle of door of room 2,next action isturn walk alone left 2  
 438   3      /////////////           
 439   3      //è¿™æ—¶å°è½¦2å·æˆ¿é—´å¤§é—¨å£ä¸­å¤®ï¼Œå‡†å¤‡è¿›å…¥2#æˆ¿é—´ï¼Œå¹¶åœ¨2å·æˆ¿é—´3#ç€ç«ç‚¹å¤„åœä¸‹æ¥ï¼
             -Œç¦»å¢™180æ¯«ç±³åœä¸‹æ¥
 440   3      ///////////////
 441   3                  
 442   3      /////////////     ///////////////////     
 443   3      //ä¿®æ”¹è·¯å¾„2019-10-2///////////////
 444   3      ////////////////////////////
 445   3                                
 446   3                  do  
 447   3                  {
 448   4                    Circulation_wall_left();//å¯»å·¦å¢™ä¿æŒ18cm
 449   4                  }while(front_dis >230);//180,210-5.20
 450   3      
 451   3                  car_stop(); 
 452   3                    
 453   3                  if(candle_fire_2==0x01)//èœ¡çƒ›2ç‡ƒçƒ§
 454   3                  {
 455   4                    turn_right_90();//å³è½¬90Â°
 456   4                    car_stop();
 457   4                    /*******************å››æ¬¡å¡å°”æ›¼æ»¤æ³¢æ˜¯å¹²ä»€ä¹ˆï¼Ÿ*********************/
 458   4                    /*********************æ­¤å¤„ä¹Ÿæœ‰é—®é¢˜ï¼******************/
 459   4                    /******************é—®é¢˜å·²è§£å†³æ”¹å˜è½¬å¼¯å»¶è¿Ÿ**********************/
 460   4                    front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 461   4                    front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 462   4                    front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 463   4                    front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 464   4                    do
 465   4                    {
 466   5                      Circulation_wall_left();
 467   5                    }while(front_dis >195);//å‰è·ç¦»20cmï¼Œ190-5.20     190å¯ä»¥ä½¿ç”¨ ç¨å¾®è¿‘ä¸€äº›  
 468   4                  
 469   4                    car_stop();
 470   4                    turn_right_90();
 471   4                    car_stop();
 472   4      /////////////           
 473   4      //è¿™æ—¶å°è½¦å¤„äº2#æˆ¿é—´3#æ‹è§’ï¼Œå‡†å¤‡å·¡å·¦å¢™ï¼Œå¹¶åœ¨ç¦»å¢™180æ¯«ç±³å¤„åœä¸‹æ¥
 474   4      ///////////////
 475   4                    
 476   4                    do
 477   4                    {
 478   5                      Circulation_wall_left();
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 9   

 479   5                    }while(front_dis >185);
 480   4              
 481   4                    car_stop();
 482   4                    delay_ms(100);
 483   4                    
 484   4                    turn_left_90_big();
 485   4                    car_stop();//--------------2ç«-----------
 486   4                    
 487   4                    do
 488   4                    {
 489   5                      Fan_On;
 490   5                      delay_ms(1500);
 491   5                      break;
 492   5                    }
 493   4                    while(LeftFire==0||RightFire==0);
 494   4                    
 495   4                    //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ2ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œ
 496   4                    do
 497   4                    {
 498   5                      Fan_On;
 499   5                      delay_ms(1500);
 500   5                      break;
 501   5                    }
 502   4                    while(LeftFire==0||RightFire==0);
 503   4                    
 504   4                  
 505   4                    Fan_Off;
 506   4                    //turn back 
 507   4        //            find_fire_turn_back_right();
 508   4        //            car_stop();
 509   4                    delay_ms(100);
 510   4                  
 511   4                    turn_left_90_big();
 512   4                    car_stop();
 513   4      
 514   4                  
 515   4                      //-----------------é˜²è¯¯åˆ¤-----2å›------ 
 516   4                    prevent_time=0;
 517   4                    do
 518   4                    {
 519   5                      Circulation_wall_right();
 520   5                      prevent_time++;
 521   5                    }
 522   4                    while(right_dis < 400&& prevent_time<5);
 523   4                    prevent_time=0;
 524   4                //----------------------------------  
 525   4                          
 526   4                
 527   4                    do
 528   4                    {
 529   5                      Circulation_wall_right();
 530   5                    }while(front_dis >198);//170,190-5.20     190å¯ä»¥ä½¿ç”¨ ç¨å¾®è¿‘ä¸€äº›---------------æ”¹  3.24  
             -195 è¿˜æ˜¯æœ‰ç‚¹è¿‘   198
 531   4                  // now potion is cornre 3 of room 2,next action  turn left
 532   4                    car_stop();
 533   4                    turn_left_90();
 534   4                    car_stop();
 535   4                  
 536   4                    if(candle_fire_3==0x01)
 537   4                    {
 538   5                      do
 539   5                      {
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 10  

 540   6                        Circulation_wall_right();
 541   6                      }while(front_dis >190);//ä¹‹å‰æ˜¯210,170-5.20
 542   5                        car_stop();
 543   5                       do
 544   5                      {
 545   6                        Fan_On;//------------------3ç«---
 546   6                        delay_ms(2000);
 547   6                        break;
 548   6                      }
 549   5                      while(LeftFire==0||RightFire==0);
 550   5                      
 551   5                      //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ2ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œ
 552   5                      do
 553   5                      {
 554   6                        Fan_On;
 555   6                        delay_ms(1000);
 556   6                        break;
 557   6                      }
 558   5                      while(LeftFire==0||RightFire==0);
 559   5                      delay_ms(1);
 560   5                      
 561   5                      //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ0.5ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œä¿è¯å¹ç­
 562   5                      while(LeftFire==0||RightFire==0)
 563   5                      {
 564   6                        Fan_On;
 565   6                        delay_ms(1000);
 566   6                        delay_ms(1000);
 567   6                        break;
 568   6                      }
 569   5                    
 570   5                      Fan_Off;
 571   5                      //////åŠ çš„
 572   5                      delay_ms(150);
 573   5                      //turn back 
 574   5        //              find_fire_turn_back_right();
 575   5                      turn_left_90();
 576   5                      car_stop();
 577   5                      goto only_fire_1_fire_9_fire_3_is_on_back_home;
 578   5                    }
 579   4                    
 580   4                    else //---------------æ— 3--
 581   4                    {
 582   5                      do
 583   5                      {
 584   6                        Circulation_wall_right();
 585   6                      }while(front_dis >185);  //180å¯ä»¥èµ° ç¨å¾®è¿œ    æ”¹  170å¤ªè¿‘äº†  -------------------æ”¹  3.
             -24  175  178æœ‰ç‚¹è¿‘   180å¯ä½†è¿˜éœ€è¦è°ƒèŠ‚
 586   5                      car_stop();
 587   5                      
 588   5                      turn_left_90();
 589   5                      
 590   5                      goto only_fire_1_fire_9_fire_3_is_on_back_home;
 591   5                    }
 592   4                }
 593   3      
 594   3               else //------------------æ— 2---
 595   3               {
 596   4                  do
 597   4                  {
 598   5                    Circulation_wall_left();
 599   5                  }while(front_dis >170);
 600   4      
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 11  

 601   4                  car_stop();
 602   4                  turn_left_90();
 603   4                  do
 604   4                  {
 605   5                    Fan_On;//---------------ç­3ç«
 606   5                    delay_ms(1500);
 607   5                    break;
 608   5                  }
 609   4                  while(LeftFire==0||RightFire==0);
 610   4                  
 611   4                  //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ2ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œ
 612   4                  do
 613   4                  {
 614   5                    Fan_On;
 615   5                    delay_ms(1);
 616   5                    break;
 617   5                  }
 618   4                  while(LeftFire==0||RightFire==0);
 619   4                  delay_ms(1);
 620   4                  
 621   4                  //å®³æ€•æ­»ç°å¤ç‡ƒï¼Œåœ0.5ç§’ï¼Œå†æ¬¡æ£€æµ‹ï¼Œä¿è¯å¹ç­
 622   4                  while(LeftFire==0||RightFire==0)
 623   4                  {
 624   5                    Fan_On;
 625   5                    delay_ms(1000);
 626   5                    delay_ms(1000);
 627   5                    break;
 628   5                  }
 629   4                  
 630   4                  Fan_Off;
 631   4                  //////åŠ çš„
 632   4                  delay_ms(100);
 633   4                  //turn back 
 634   4      //              find_fire_turn_back_right();
 635   4      //              car_stop();
 636   4                }
 637   3                turn_left_90();
 638   3                car_stop();
 639   3                  
 640   3                goto only_fire_1_fire_9_fire_3_is_on_back_home;
 641   3      
 642   3                  
 643   3                  
 644   3                  
 645   3      //---------------------å‡†å¤‡å›å¤´-------------------            
 646   3                  
 647   3        
 648   3      
 649   3      
 650   3      
 651   3                  
 652   3      
 653   3      /////////////////
 654   3      //
 655   3      //åœ¨ç€ç«ç‚¹3ä½ç½®ï¼Œå‡†å¤‡é©¶å‡º2#æˆ¿é—´ï¼Œå¹¶åœ¨3#è¡—é“åœä¸‹æ¥ï¼Œç¦»å¢™180æ¯«ç±³åœã€‚
 656   3      ////////////////////            
 657   3                // now potion is cornre 3 of  room 2,next action  walk alone righr wall
 658   3      only_fire_1_fire_9_fire_3_is_on_back_home:            
 659   3                  //-----------------é˜²è¯¯åˆ¤-----------
 660   3      //                prevent_time=0;           
 661   3      //                do
 662   3      //                {
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 12  

 663   3      //                  Circulation_wall_right();
 664   3      //                  prevent_time++;
 665   3      //                }
 666   3      //                while(right_dis < 200&&prevent_time<5);//é©¶å‡ºæˆ¿é—´2èµ°å‘3å·è¡—åŒºå³ä¾§è·ç¦»39cmâ€”â€”è¯¥ä
             -¸º20cm-5.18
 667   3      //                prevent_time=0;
 668   3      //              //----------------------------------  
 669   3                  
 670   3                  
 671   3                  do
 672   3                  {
 673   4                    Circulation_wall_right();
 674   4                  }while(front_dis >410);
 675   3                // now potion is cornre 4 of room 2,next action  turn left
 676   3                  car_stop();
 677   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 678   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 679   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 680   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 681   3                  do
 682   3                  {
 683   4                                    
 684   4      //             forward();
 685   4                    Circulation_wall_right();
 686   4                   
 687   4                  }while(front_dis >200);
 688   3                  car_stop();
 689   3                  turn_left_90();
 690   3                  car_stop();
 691   3                // now potion is  door of room 2,and meanwhile at the street 3,next action   walk alone righr wall
 692   3      /////////////           
 693   3      //è¿™æ—¶å°è½¦å¤„äº3#å¤§è¡—ï¼Œå·¡å³å¢™èµ°ï¼Œå¹¶æ‰«æå·¦å¢™ï¼Œç¨³å®šå‘ç°å·¦å¢™
 694   3      ///////////////
 695   3      
 696   3                  left_300=0x00;
 697   3                  do
 698   3                  {
 699   4                    Circulation_wall_right();
 700   4                    left_dis= Ultrasonic_Get_Left();
 701   4                    
 702   4                    if(left_dis<300)
 703   4                    {
 704   5                      left_300++;
 705   5                    }
 706   4                    else
 707   4                    {
 708   5                      left_300=0x00;
 709   5                    }
 710   4                  }
 711   3                  while(left_dis>300||left_300<=3);//front_dis > 580||left_dis <600
 712   3      //            car_stop();
 713   3      //            car_stop();
 714   3                  
 715   3                  
 716   3                  
 717   3      /////////////           
 718   3      //è¿™æ—¶å°è½¦å¤„äº3#å¤§è¡—ï¼Œå‘ç°å·¦å¢™ï¼Œå‡†å¤‡å·¡å·¦å¢™èµ°ï¼Œå¹¶åœ¨å‰å¢™170æ¯«ç±³å¤„åœä¸‹
 719   3      ///////////////           
 720   3        
 721   3                  do
 722   3                    
 723   3                  {
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 13  

 724   4                    Circulation_wall_left();
 725   4                  }while(front_dis >210);   //200å¯ä»¥ä½¿ç”¨   å¯ä»¥è°ƒå¤§ä¸€äº›  ------------æ”¹210  3.24
 726   3                  car_stop();
 727   3                  turn_right_90();
 728   3      /////////////           
 729   3      //è¿™æ—¶å°è½¦å¤„äº2#å¤§è¡—å°½å¤´ï¼Œå‡†å¤‡å·¡å·¦å¢™èµ°ï¼Œå¹¶åœ¨å‰å¢™170æ¯«ç±³å¤„åœä¸‹
 730   3      ///////////////             
 731   3                  do
 732   3                    
 733   3                  {
 734   4                    Circulation_wall_left();
 735   4                  }while(front_dis >210);//åŸæ•°æ®180
 736   3                  car_stop();
 737   3                  turn_right_back_90(); 
*** WARNING C206 IN LINE 737 OF main.c: 'turn_right_back_90': missing function-prototype
 738   3                  
 739   3      /////////////           
 740   3      //è¿™æ—¶å°è½¦å¤„äº1#ç€ç«ç‚¹ï¼Œå‡†å¤‡å·¡å·¦å¢™èµ°ï¼Œå¹¶åœ¨å‰å¢™580æ¯«ç±³å¤„åœä¸‹ï¼Œå¹¶æ‰å¤´ï¼Œä¸ºä¸‹
             -æ¬¡å¯åŠ¨åšå‡†å¤‡
 741   3      /////////////// 
 742   3      only_fire_9_fire_1_is_on_back_home:           
 743   3                  car_stop();
 744   3                  
 745   3      only_fire1_is_on_back_home: 
 746   3                  
 747   3      //            i=0;
 748   3      //            do
 749   3      //            {
 750   3      //              Circulation_wall_left();
 751   3      //            }while(i<=30);
 752   3                  
 753   3                  
 754   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 755   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 756   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 757   3                  front_dis= kalmanfilter(Ultrasonic_Get_Front(),1);
 758   3                  
 759   3                  do
 760   3                  {
 761   4                    Circulation_wall_left();
 762   4                  }while(front_dis >580);
 763   3                  //car_stop();
 764   3                  //car_stop(); 
 765   3      
 766   3                  do
 767   3                    
 768   3                  {
 769   4                    Circulation_wall_left();
 770   4                  }while(front_dis >500);
 771   3      //            car_stop();               
 772   3      
 773   3                  do
 774   3                    
 775   3                  {
 776   4                    Circulation_wall_left();
 777   4                  }while(front_dis >430);//-------------10.15
 778   3                  do
 779   3                    
 780   3                  {
 781   4                    Circulation_wall_left();
 782   4                  }while(front_dis >430);//-------------10.15
 783   3                  do
C51 COMPILER V9.60.0.0   MAIN                                                              10/15/2023 16:50:55 PAGE 14  

 784   3                    
 785   3                  {
 786   4                    Circulation_wall_left();
 787   4                  }while(front_dis >430);//-------------10.15
 788   3                  do
 789   3                    
 790   3                  {
 791   4                    Circulation_wall_left();
 792   4                  }while(front_dis >430);//-------------10.15
 793   3                  car_stop();
 794   3                  car_stop(); 
 795   3                  delay_ms(100);
 796   3                  car_stop();
 797   3                  while(1);
 798   3                  
 799   3          }
 800   2        }
 801   1      }
 802                
*** WARNING C294 IN LINE 85 OF main.c: unreachable code
*** WARNING C294 IN LINE 94 OF main.c: unreachable code
*** WARNING C294 IN LINE 212 OF main.c: unreachable code
*** WARNING C294 IN LINE 221 OF main.c: unreachable code
*** WARNING C294 IN LINE 493 OF main.c: unreachable code
*** WARNING C294 IN LINE 502 OF main.c: unreachable code
*** WARNING C294 IN LINE 549 OF main.c: unreachable code
*** WARNING C294 IN LINE 558 OF main.c: unreachable code
*** WARNING C294 IN LINE 609 OF main.c: unreachable code
*** WARNING C294 IN LINE 618 OF main.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1522    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      4    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  11 WARNING(S),  0 ERROR(S)
